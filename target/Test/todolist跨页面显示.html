<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>todolist跨页面显示</title>
    <link rel="stylesheet" href="CSS/todolist_MR.css" type="text/css"/>
    <!-- <style type="text/css">
        *{
            padding: 0;
            margin: 0;
        }

        .sidebar_MR{
            position: fixed;
            right: 0;
            top: 100px;
        }

    /* ————————————————— todolist Part ——————————————————— */
        .todolist_OutsideBox_MR{
            width: 320px;
            padding: 15px 15px;
            border-radius: 10px 0 0 10px;
            background: #f7f7f7;
            box-shadow: 1px 1px 10px rgba(0,0,0,0.25);
            background: #fff;
            /* border: 4px solid rgba(68, 87, 96,0.5); */
        }

        /* ———————————————— 输入框 —————————————————— */
        #todoTitle_MR{
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            font-family: Arial;
        }

        #todolistInput_MR{
            width: 300px;
            height: 36px;
            margin: 12px 0;
            font-size: 16px;
            text-indent: 10px;
            border-radius: 5px;
            background: #f0f6f4;
            /* box-shadow: 0 1px 0 rgba(255, 255, 255, 0.24), 0 1px 6px rgba(0, 0, 0, 0.45) inset; */
            border: none;
            outline: none;
            box-shadow: 1px 1px 5px rgba(0, 0, 0, 0.2);
            /* border: 1px solid #f00; */
        }

        /* ———————————————— 标题 —————————————————— */
        .todolist_OutsideBox_MR h3{
            position: relative;
            margin-top: 10px;
            letter-spacing: 1px;
            /* border: 1px solid #f00; */
        }
        
        #todocount_MR,#donecount_MR{
            position: absolute;
            top: 6px;
            right: 10px;
            padding: 1px 5px;
            display: inline-block;
            border-radius: 50%;
            color: #fff;
            font-size: 14px;
            background-color: #79aea4;
            /* border: 1px solid #f00; */
        }
        
        /* ———————————————— 标签 —————————————————— */
        .demoBox_MR{
            padding: 0;
            margin: 15px 0 30px 0;
            list-style-type: none;
        }

        .demoBox_MR li{
            position: relative;
            margin: 6px 5px;
            padding: 15px 5px;
            background: #fff;
            border-radius: 6px;
            letter-spacing: 0.5px;
            box-shadow: 1px 1px 10px rgba(0, 0, 0, 0.15);
            /* border: .5px solid #fff; */
            /* border: 1px solid #f00; */
        }

        .demoBox_MR li p{
            position: absolute;
            top: 4px;
            left: 25px;
            letter-spacing: 0.5px;
        }
        
        .demoBox_MR li input{
            position: absolute;
            top: 8px;
            left: 6px;
            cursor: pointer;
            border: 1px solid #0f0;
        }

        .demoBox_MR li > a{
            width: 14px;
            height: 14px;
            line-height: 14px;
            text-align: center;
            position: absolute;
            top: 4px;
            right: 5px;
            display: inline-block;
            text-decoration: none;
            border-radius: 50%;
            border: 3px solid #bdbdbe;
            cursor: pointer;
        }

        /* 里面的小叉叉 */
        .demoBox_MR li > a > span{
            color: #666;
            font-weight: bold;
        }

        .demoBox_MR li:hover{
            cursor: pointer;
            /* border: .5px solid #666; */
            box-shadow: 1px 1px 10px rgba(0, 0, 0, 0.3);
        }

        /* ———————————————————— 隐藏按钮 ———————————————————— */
        #todolist_hidden_MR{
            width: 60px;
            height: 60px;
            position: absolute;
            top: 10px;
            left: -100px;
            border: none;
            border-radius: 50%;
            border: 1px solid #f00;
        }

        .hideBox{
            margin-right: -300px;
            /* right: -350px; */
            /* transition: all ease-in-out 1s; */
        }

    /* ———————————————————— 便签记事本 ——————————————————————— */
        #notepad_MR{
            width: 300px;
            padding: 10px;
            line-height: 25px;
            font-size: 16px;
            font-family: "Microsoft YaHei";
            letter-spacing: 0.5px;
            border: none;
            outline: none;
            resize: none;   /* 禁止拉伸 */
            border: 1px solid #f00;
        }

        .ddd{
            width: 220px;
            height: 100px;
            border: 1px solid #f00;
            background: -moz-linear-gradient(#f7f7f7,#f00);
            
        }
    </style> -->
</head>
<body>
    <div class="sidebar_MR">
        <button id="todolist_hidden_MR">—</button>
        <button id="todolist_show_MR">
            ToDoList
            <span>+</span>
        </button>
        <div class="todolist_OutsideBox_MR">
            <label id="todoTitle_MR" for="todoTitle_MR">ToDoList</label><br/>
            <input type="text" id="todolistInput_MR" name="title" placeholder="添加ToDo..." required="required" autocomplete="off" />
            <section>
                <!-- ———————————— 待办事项<ol> —————————————— -->
                <h3>正在进行<span id="todocount_MR">0</span></h3>
                <ol id="todolist_MR" class="demoBox_MR">
                </ol>
                <!-- ———————————— 已经完成<ul> —————————————— -->
                <h3>已经完成 <span id="donecount_MR">0</span></h3>
                <ul id="donelist_MR" class="demoBox_MR">
                </ul>
            </section>
        </div>
    </div>
    
</body>
<script src="JS/jQuery.js"></script>
<script src="JS/todolist_MR.js"></script>
<!-- <script>

// $(".sidebar_MR").addClass("hideBox");
    //点击隐藏和点击出现
    $("#todolist_hidden_MR").on({
        click: function()
        {
            // $(element).is(":visible");hidden(隐藏),:first(第一个),:last(最后一个)
            if($(".todolist_OutsideBox_MR").is(":hidden"))
            {
                $(".todolist_OutsideBox_MR").show(500);
                // $(".todolist_OutsideBox_MR").fadeIn();
            }
            else{
                $(".todolist_OutsideBox_MR").hide(500);
                // $(".todolist_OutsideBox_MR").fadeOut();
            }
            
            // $(".sidebar_MR").toggleClass("hideBox").animate({
            //     transition: "all ease-in-out 1s",
            //     border: "1px solid #f00"
            // },200);
            // $(".sidebar_MR")
            
        }
    });

    //————————————————— 获取数据 ———————————————————————
    //按下回车，把完整数据存储到Local Storage
    //存储格式：var todolist = [{title:"XXX", done:false}]
    load(); //页面初始化，页面一加载，就把本地存储的数据渲染在页面上
    $("#todolistInput_MR").on({
        keydown: function(event)
        {   
            if(event.keyCode == 13) //按下回车
            {
                if($(this).val() == "") //输入文本为空
                {
                    alert("请输入文本");
                }
                else{
                    var local_MR = getData();   //创建local_MR数组
                    //往数组里更新存储数据，target：设定目标，done：完成状态
                    local_MR.push({
                        target: $(this).val(),
                        done: false
                    });

                    saveData(local_MR); //把数组local存储给本地
                    load();     //读取本地数据渲染到页面中
                    $(this).val("");    //当按下回车，清除输入框内的内容
                }
            }
        }
    });

    //————————————— 读取本地存储数据 ——————————————————
    //读取Local Storage存放的数据（将字符串转换为对象格式）
    function getData()
    {
        var data = localStorage.getItem("todolist");
        if(data != null)    //确保有数据，才获取
        {
            return JSON.parse(data);    //将本地里字符串格式转换回对象（外边用的是对象格式）
        }
        else{   //本地存储为空，直接返回一个空数组
            return [];
        }
    }

    //————————————— 保存本地存储数据 ——————————————————
    //将对象转换为字符串，即以JSON的格式存储进本地
    function saveData(data)
    {
        localStorage.setItem("todolist",JSON.stringify(data));
    }

    //————————————— 渲染加载本地存储数据 ——————————————————
    function load()
    {
        var data = getData();   //先读取本地存储数据
        //为了防止每次按下回车后，页面自动渲染与车渲染叠加渲染两次，故在加载时，先清空原有内容
        $("#todolist_MR,#donelist_MR").empty();

        //显示的统计个数
        var todoCount = 0;  //正在进行的个数
        var doneCount = 0;  //已经完成的个数

        //遍历这个数组
        $.each(data,function(i,n)   //i索引号，n为data数组里对应的数据
        {
            if(n.done == false) //未完成的
            {
                var olStr = "<li>"+
                    "<input class='check_MR' type = 'checkbox'/>"+
                    "<p>"+n.target+"</p>"+
                    "<a class='delete_MR' href='Javascript:;' number='"+i+"'/></a>"+
                "</li>";
                $("#todolist_MR").prepend(olStr);
                todoCount++;
            }
            else{   //已完成的
                var ulStr = "<li>"+
                    "<input class='check_MR' type = 'checkbox' checked='checked'/>"+
                    "<p>"+n.target+"</p>"+
                    "<a class='delete_MR' href='Javascript:;' number='"+i+"'/></a>"+
                "</li>";
                $("#donelist_MR").prepend(ulStr);
                doneCount++;
            }
        });

        //更改页面显示的个数
        $("#todocount_MR").text(todoCount);
        $("#donecount_MR").text(doneCount);
    }

    //————————————— 实现本地存储的删除操作 ——————————————————
    function deleteData(list)
    {
        list.on("click",".delete_MR",function()
        {
            var data = getData();   //先获取本地数据
            //获取索引号
            var index = $(this).attr("number");
            data.splice(index,1);   //删除索引号所在本身的数据
            saveData(data); //将删除后的数据重新存储，迭代更新本地的存储数据
            load(); //将数据重新渲染到页面
        });
    }

    deleteData($("#todolist_MR"));  //正在进行的
    deleteData($("#donelist_MR"));  //已经完成的

    //————————————— 切换正在进行和已经完成的选项 ——————————————————
    function switchList(list)
    {
        list.on("click",".check_MR",function()
        {
            var data = getData();   //先获取本地存储的数据
            //修改数据（点击复选框，获取与它同级的兄弟<a>的自定义属性）
            var index = $(this).siblings("a").attr("number");
            //将当前复选框中是否选中这一状态与存储的data的done属性的false/true绑定
            data[index].done = $(this).prop("checked");
            saveData(data); //将删除后的数据重新存储，迭代更新本地的存储数据
            load(); //将数据重新渲染到页面
        });
    }

    switchList($("#todolist_MR"));  //正在进行的
    switchList($("#donelist_MR"));  //已经完成的
</script> -->
</html>